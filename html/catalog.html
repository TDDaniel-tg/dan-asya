<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ö–∞—Ç–∞–ª–æ–≥</title>
  <link rel="stylesheet" href="/css/styles.css">
  <link rel="stylesheet" href="/css/catalog.css">
</head>
<body>
  <!-- –•–≠–î–ï–† -->
  <header class="header">
    <div class="burger" onclick="toggleMenu()">
      <div></div>
      <div></div>
      <div></div>
    </div>
  
    <div class="logo">
      <img src="logo.png" alt="Frag Store" />
    </div>
  
    <nav class="navigation">
      <a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
      <!-- –°—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞—Ç–∞–ª–æ–≥ -->
      <a href="catalog.html">–ö–∞—Ç–∞–ª–æ–≥</a>
      <div class="pages-menu" id="pagesMenu">
        <a href="#">–°—Ç—Ä–∞–Ω–∏—Ü—ã</a>
        <div class="dropdown">
          <a href="about.html">–û –Ω–∞—Å</a>
          <a href="how-to-order.html">–ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑</a>
          <a href="delivery-pay.html">–î–æ—Å—Ç–∞–≤–∫–∞ –∏ –æ–ø–ª–∞—Ç–∞</a>
        </div>
      </div>
      <a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
    </nav>
  
    <!-- –ù–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∏–∫–æ–Ω–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è —Å–ø—Ä–∞–≤–∞ -->
    <div class="header-right">
      <div class="icons" id="login-container">
        <!-- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Å—ã–ª–∫—É "–í–æ–π—Ç–∏" -->
        <a href="login.html" class="icon login-icon">–í–æ–π—Ç–∏</a>
      </div>
      <div class="icons">
        <div class="icon search-icon" onclick="toggleSearch()">üîç</div>
        <a href="cart.html" class="icon cart-icon">üõí</a>
      </div>
    </div>
  
    <!-- –ü–æ–ª–µ –ø–æ–∏—Å–∫–∞ -->
    <div class="search-bar hidden" id="searchBar">
      <input type="text" placeholder="–ü–æ–∏—Å–∫..." />
    </div>
  </header>

  <main>
    <h1>–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</h1>
    <div id="product-list"></div>
  </main>

  <script>
    // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é
    function toggleMenu() {
      const burger = document.querySelector('.burger');
      const mobileNav = document.querySelector('.mobile-nav');
      burger.classList.toggle('open');
      if (mobileNav) mobileNav.classList.toggle('active');
    }
    
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥–º–µ–Ω—é "–°—Ç—Ä–∞–Ω–∏—Ü—ã"
    const pagesMenu = document.getElementById('pagesMenu');
    pagesMenu.addEventListener('click', (event) => {
      event.stopPropagation();
      pagesMenu.classList.toggle('open');
    });
    document.addEventListener('click', () => {
      pagesMenu.classList.remove('open');
    });
    
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ–∏—Å–∫–∞
    function toggleSearch() {
      const searchBar = document.getElementById('searchBar');
      searchBar.classList.toggle('hidden');
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—Ö–æ–¥–∞ (—É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –≥–ª–∞–≤–Ω—É—é)
    function logout() {
      localStorage.removeItem('token');
      window.location.href = '/';
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: –µ—Å–ª–∏ —Ç–æ–∫–µ–Ω –µ—Å—Ç—å, –∑–∞–º–µ–Ω—è–µ–º –±–ª–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Å—Å—ã–ª–∫—É –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —Å –∫–Ω–æ–ø–∫–æ–π "–í—ã–π—Ç–∏"
    document.addEventListener('DOMContentLoaded', () => {
      const token = localStorage.getItem('token');
      const loginContainer = document.getElementById('login-container');
      if (token) {
        loginContainer.innerHTML = `
          <a href="private.html" class="icon user-icon">üôç‚Äç‚ôÇÔ∏è</a>
          <button onclick="logout()" class="logout-btn">–í—ã–π—Ç–∏</button>
        `;
      }
    });
    
    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ —Å —Å–µ—Ä–≤–µ—Ä–∞ –∏ –≤—ã–≤–æ–¥ –∏—Ö –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
    document.addEventListener("DOMContentLoaded", async function () {
      try {
        const response = await fetch('/api/products');
        const products = await response.json();
        const productList = document.getElementById("product-list");
        productList.innerHTML = products.map(product => `
          <div class="product-card">
            <img src="${product.image}" alt="${product.name}">
            <h2>${product.name}</h2>
            <p>${product.description}</p>
            <p>–¶–µ–Ω–∞: ${product.price}‚ÇΩ</p>
            <button class="add-to-cart" onclick="addToCart('${product._id}')">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
          </div>
        `).join("");
      } catch (error) {
        console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤:", error);
      }
    });
    
    // –ü—Ä–∏–º–µ—Ä —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É
    function addToCart(productId) {
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      if (!cart.includes(productId)) {
        cart.push(productId);
        localStorage.setItem('cart', JSON.stringify(cart));
        alert("–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É");
      } else {
        alert("–¢–æ–≤–∞—Ä —É–∂–µ –≤ –∫–æ—Ä–∑–∏–Ω–µ");
      }
    }
  </script>
</body>
</html>
